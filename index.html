<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Maze Puzzle - Reaching Aria</title>
  <style>
    body {
      background-color: black;
      color: white;
      font-family: 'Press Start 2P', cursive;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    canvas {
      border: 2px solid white;
      margin: 20px 0;
    }
    .dialogue-box {
      background: black;
      border: 2px solid white;
      padding: 16px;
      width: 90%;
      max-width: 400px;
      text-align: left;
      font-size: 10px;
      line-height: 1.6;
    }
    #nextBtn {
      margin-top: 10px;
      padding: 6px 10px;
      background: white;
      color: black;
      font-family: 'Press Start 2P', cursive;
      font-size: 10px;
      cursor: pointer;
      border: none;
    }
  </style>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>

<div class="dialogue-box" id="dialogue">
  <p id="dialogueText">You feel a pull in your soul... something—or someone—awaits.</p>
  <button id="nextBtn" onclick="startMaze()">Start</button>
</div>

<canvas id="mazeCanvas" width="400" height="400" style="display:none;"></canvas>

<script>
const mazes = [
  // Round 1: Simple
  [
    [1,1,1,1,1,1,1,1,1,1],
    [1,0,0,0,1,0,0,0,0,1],
    [1,0,1,0,1,0,1,1,0,1],
    [1,0,1,0,0,0,0,1,0,1],
    [1,0,1,1,1,1,0,1,0,1],
    [1,0,0,0,0,1,0,0,0,1],
    [1,1,1,1,0,1,1,1,0,1],
    [1,0,0,1,0,0,0,1,0,1],
    [1,0,1,1,1,1,0,1,0,1],
    [1,1,1,1,1,1,1,1,1,1],
  ],
  // Round 2: Medium (based on image)
  [
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,0,0,1,0,0,1,0,0,1,0,1,0,1,0,0,0,0,0,1],
    [1,1,0,1,1,0,1,1,0,1,0,1,0,1,1,1,1,1,0,1],
    [1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,1,0,1],
    [1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1],
    [1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1],
    [1,0,1,1,0,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1],
    [1,0,1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1],
    [1,0,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,0,1],
    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
  ],
  // Round 3: Hard + Congratulations redirect
  [
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,0,0,1,0,0,1,0,0,1,0,1,0,1,0,0,0,0,0,1],
    [1,1,0,1,1,0,1,1,0,1,0,1,0,1,1,1,1,1,0,1],
    [1,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,1,0,1],
    [1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1,1,0,1],
    [1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,1],
    [1,0,1,1,0,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1],
    [1,0,1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1],
    [1,0,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,0,1],
    [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
  ]
];

let round = 0;
const canvas = document.getElementById("mazeCanvas");
const ctx = canvas.getContext("2d");
let player = {x:1, y:1};

function drawMaze(maze) {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  const cellSize = canvas.width / maze[0].length;
  for (let y = 0; y < maze.length; y++) {
    for (let x = 0; x < maze[0].length; x++) {
      if (maze[y][x] === 1) {
        ctx.fillStyle = "white";
        ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
      }
    }
  }
  drawPlayer(cellSize);
}

function drawPlayer(cellSize) {
  ctx.fillStyle = "red";
  ctx.fillRect(player.x * cellSize, player.y * cellSize, cellSize, cellSize);
}

function startMaze() {
  document.getElementById("dialogue").style.display = "none";
  canvas.style.display = "block";
  const currentMaze = mazes[round];
  player = {x:1, y:1};
  drawMaze(currentMaze);
  window.addEventListener("keydown", handleKey);
}

function handleKey(e) {
  const maze = mazes[round];
  const dx = {ArrowLeft: -1, ArrowRight: 1, ArrowUp: 0, ArrowDown: 0};
  const dy = {ArrowLeft: 0, ArrowRight: 0, ArrowUp: -1, ArrowDown: 1};
  if (dx[e.key] !== undefined) {
    const newX = player.x + dx[e.key];
    const newY = player.y + dy[e.key];
    if (maze[newY][newX] === 0) {
      player.x = newX;
      player.y = newY;
      drawMaze(maze);
      if (player.y === maze.length - 2 && player.x === maze[0].length - 2) {
        window.removeEventListener("keydown", handleKey);
        nextRound();
      }
    }
  }
}

function nextRound() {
  round++;
  if (round >= mazes.length) {
    window.location.href = "#youmadeit";
  } else {
    document.getElementById("dialogueText").innerText = round === 1
      ? "You're getting closer... Can you feel it?"
      : "Just a few more steps..."
    document.getElementById("dialogue").style.display = "block";
    canvas.style.display = "none";
    document.getElementById("nextBtn").innerText = "Next";
  }
}
</script>

</body>
</html>
