<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>3-Round Maze Game</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
  body {
    margin: 0;
    font-family: 'Press Start 2P', monospace;
    background: black;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    position: relative;
  }
  canvas {
    border: 3px solid white;
    background: #000;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    width: min(90vw, 400px);
    height: auto;
  }
  #instructions {
    margin-top: 10px;
    font-size: 10px;
    color: #87cefa;
    max-width: 80vw;
    text-align: center;
    min-height: 3em;
  }
  #celebrateMsg {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: black;
    border: 2px solid white;
    padding: 10px 20px;
    font-size: 10px;
    text-align: center;
    display: none;
    z-index: 10;
    white-space: nowrap;
  }
  button {
    margin-top: 10px;
    font-family: 'Press Start 2P', monospace;
    font-size: 8px;
    padding: 4px 8px;
    background: black;
    color: white;
    border: 2px solid white;
    cursor: pointer;
  }
  button:hover {
    background: white;
    color: black;
  }
</style>
</head>
<body>

<canvas id="maze" width="400" height="400"></canvas>
<div id="instructions">Use arrow keys to move the white square to reach Aria.</div>
<div id="celebrateMsg"></div>
<button id="resetBtn">Reset Game</button>

<script>
  const canvas = document.getElementById("maze");
  const ctx = canvas.getContext("2d");
  const celebrateMsg = document.getElementById('celebrateMsg');
  const instructions = document.getElementById('instructions');
  const resetBtn = document.getElementById('resetBtn');

  const avatarImg = new Image();
  avatarImg.src = "https://i.imgur.com/9OC7GRw.gif";

  // 1 = wall, 0 = path, 2 = goal
  const mazes = [
    // Round 1: Your original maze
    [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1],
      [1,0,1,1,0,1,0,1,1,1,1,0,1,0,1,1,1,1,0,1],
      [1,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,1,0,1],
      [1,0,1,0,1,1,1,1,1,0,1,0,1,1,1,1,0,1,0,1],
      [1,0,1,0,0,0,0,0,1,0,1,0,0,0,0,1,0,1,0,1],
      [1,0,1,1,1,1,1,0,1,1,1,1,1,1,0,1,0,1,0,1],
      [1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,1],
      [1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,0,1],
      [1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1],
      [1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,0,1],
      [1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,1],
      [1,1,1,1,1,1,1,1,0,1,1,1,1,1,0,1,0,1,0,1],
      [1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1],
      [1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1,0,1,0,1],
      [1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,1],
      [1,1,1,1,0,1,1,1,1,1,0,1,1,1,0,1,0,1,0,1],
      [1,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1],
      [1,0,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,2,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
    ],

    // Round 2: More complex maze
    [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,1,0,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,1],
      [1,0,1,0,1,1,0,1,1,0,1,0,1,0,1,1,1,1,0,1],
      [1,0,1,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,1],
      [1,0,1,1,1,0,1,0,1,1,1,0,1,1,1,1,0,1,0,1],
      [1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,1,0,1],
      [1,1,1,1,1,0,1,1,1,0,1,1,1,1,0,1,0,1,0,1],
      [1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,1,0,0,0,1],
      [1,0,1,0,1,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1],
      [1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,1],
      [1,0,1,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,0,1],
      [1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,1,0,1],
      [1,1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,0,1,0,1],
      [1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1],
      [1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,1,0,1,0,1],
      [1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,1],
      [1,1,1,1,0,1,1,1,1,1,0,1,1,1,0,1,0,1,0,1],
      [1,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,1],
      [1,0,1,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,2,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
    ],

    // Round 3: Hardest maze (from your image)
    [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,1,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,1],
      [1,0,0,1,0,1,1,1,1,0,1,0,1,0,0,1,0,1,0,1],
      [1,1,0,1,0,0,0,0,1,0,0,0,1,0,0,1,0,1,0,1],
      [1,1,0,1,1,1,1,0,1,1,1,1,1,0,1,1,0,1,0,1],
      [1,1,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1],
      [1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,0,1],
      [1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1],
      [1,0,1,0,1,0,1,0,1,1,1,1,1,1,1,1,0,1,0,1],
      [1,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1],
      [1,0,1,1,1,1,1,1,1,0,1,1,1,1,0,1,1,1,0,1],
      [1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0,1],
      [1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,0,1,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,1,0,1],
      [1,0,1,1,1,1,0,1,1,1,1,1,1,1,0,1,0,1,0,1],
      [1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1],
      [1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,0,1,0,1],
      [1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,1],
      [1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,2,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
    ]
  ];

  const TILE_SIZE = 20;
  const ROWS = mazes[0].length;
  const COLS = mazes[0][0].length;

  let player = { row: 1, col: 1 };
  let currentRound = 0;

  function drawMaze() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    for (let r = 0; r < ROWS; r++) {
      for (let c = 0; c < COLS; c++) {
        let tile = mazes[currentRound][r][c];
        switch(tile) {
          case 1: // Wall
            ctx.fillStyle = 'blue';
            ctx.fillRect(c * TILE_SIZE, r * TILE_SIZE, TILE_SIZE, TILE_SIZE);
            break;
          case 0: // Path
            ctx.fillStyle = 'black';
            ctx.fillRect(c * TILE_SIZE, r * TILE_SIZE, TILE_SIZE, TILE_SIZE);
            break;
          case 2: // Goal (Aria)
            ctx.fillStyle = 'black';
            ctx.fillRect(c * TILE_SIZE, r * TILE_SIZE, TILE_SIZE, TILE_SIZE);
            ctx.drawImage(avatarImg, c * TILE_SIZE, r * TILE_SIZE, TILE_SIZE, TILE_SIZE);
            break;
        }
      }
    }

    // Draw player (white square)
    ctx.fillStyle = 'white';
    ctx.fillRect(player.col * TILE_SIZE + 3, player.row * TILE_SIZE + 3, TILE_SIZE - 6, TILE_SIZE - 6);
  }

  function canMove(r, c) {
    if (r < 0 || r >= ROWS || c < 0 || c >= COLS) return false;
    return mazes[currentRound][r][c] !== 1;
  }

  function checkGoal() {
    return mazes[currentRound][player.row][player.col] === 2;
  }

  function resetPlayer() {
    // Find the first path tile to place player at start
    for (let r=0; r < ROWS; r++) {
      for (let c=0; c < COLS; c++) {
        if (mazes[currentRound][r][c] === 0) {
          player.row = r;
          player.col = c;
          return;
        }
      }
    }
  }

  function showCelebrateMessage(text, callback) {
    celebrateMsg.textContent = text;
    celebrateMsg.style.display = 'block';
    setTimeout(() => {
      celebrateMsg.style.display = 'none';
      callback();
    }, 2000);
  }

  function startRound(roundIndex) {
    currentRound = roundIndex;
    resetPlayer();
    instructions.textContent = Round ${roundIndex+1}: Use arrow keys to reach Aria.;
    drawMaze();
  }

  function nextRound() {
    if (currentRound + 1 < mazes.length) {
      showCelebrateMessage('Question Solved! Proceeding to next round...', () => {
        startRound(currentRound + 1);
      });
    } else {
      showCelebrateMessage('Congratulations, you did it!', () => {
        instructions.textContent = 'Game complete! Thank you for playing.';
        drawMaze();
      });
    }
  }

  window.addEventListener('keydown', e => {
    let newRow = player.row;
    let newCol = player.col;
    switch(e.key) {
      case 'ArrowUp': newRow--; break;
      case 'ArrowDown': newRow++; break;
      case 'ArrowLeft': newCol--; break;
      case 'ArrowRight': newCol++; break;
      default: return;
    }
    if (canMove(newRow, newCol)) {
      player.row = newRow;
      player.col = newCol;
      drawMaze();
      if (checkGoal()) {
        nextRound();
      }
    }
  });

  resetBtn.addEventListener('click', () => {
    startRound(0);
  });

  avatarImg.onload = () => {
    startRound(0);
  };
</script>

</body>
</html>
